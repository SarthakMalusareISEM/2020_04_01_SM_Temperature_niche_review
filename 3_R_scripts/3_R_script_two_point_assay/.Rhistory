m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Standard_error_female))
df0 <- df%>% slice(1:9)
df0$Error_squared= df0$Standard_error_female*df0$Standard_error_female
df0$Mean_squared=df0$Mean_female*df0$Mean_female
Selection_line_fecundity_monogamous <- df0 %>%
filter(Control_or_selection_line== "Monogamous 28")
Control_line_fecundity_monogamous<- df0 %>%
filter(Control_or_selection_line== "Control monogamous 20")
df1<- left_join(Selection_line_fecundity_monogamous,Control_line_fecundity_monogamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_monogamous = Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_mean_fecundity_monogamous*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean_fecundity_monogamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity monogamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2)+
geom_errorbar(aes(ymin=Relative_mean_fecundity_monogamous-Combined_CI, ymax=Relative_mean_fecundity_monogamous+Combined_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
View(df1)
df1$Combined_CI
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
setwd("/home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review/Graphs_and_R_codes/Two _point_papers/1_data_two_point_assay")
df<-read.table(file="Plesnar_Bielak_et_al_2012.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-28
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Standard_error_female))
df0 <- df%>% slice(1:9)
df0$Error_squared= df0$Standard_error_female*df0$Standard_error_female
df0$Mean_squared=df0$Mean_female*df0$Mean_female
Selection_line_fecundity_monogamous <- df0 %>%
filter(Control_or_selection_line== "Monogamous 28")
Control_line_fecundity_monogamous<- df0 %>%
filter(Control_or_selection_line== "Control monogamous 20")
df1<- left_join(Selection_line_fecundity_monogamous,Control_line_fecundity_monogamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_monogamous = Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_mean_fecundity_monogamous*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean_fecundity_monogamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity monogamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2.5)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_mean_fecundity_monogamous-Combined_CI, ymax=Relative_mean_fecundity_monogamous+Combined_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
setwd("/home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review/Graphs_and_R_codes/Two _point_papers/1_data_two_point_assay")
df<-read.table(file="Plesnar_Bielak_et_al_2012.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-28
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Standard_error_female))
df0 <- df%>% slice(1:9)
df0$Error_squared= df0$Standard_error_female*df0$Standard_error_female
df0$Mean_squared=df0$Mean_female*df0$Mean_female
Selection_line_fecundity_monogamous <- df0 %>%
filter(Control_or_selection_line== "Monogamous 28")
Control_line_fecundity_monogamous<- df0 %>%
filter(Control_or_selection_line== "Control monogamous 20")
df1<- left_join(Selection_line_fecundity_monogamous,Control_line_fecundity_monogamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_monogamous = Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_mean_fecundity_monogamous*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean_fecundity_monogamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity monogamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2.5)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_mean_fecundity_monogamous-Combined_CI, ymax=Relative_mean_fecundity_monogamous+Combined_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
setwd("/home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review/Graphs_and_R_codes/Two _point_papers/1_data_two_point_assay")
df<-read.table(file="Plesnar_Bielak_et_al_2012.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-28
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Standard_error_female))
df0 <- df%>% slice(1:9)
df0$Error_squared= df0$Standard_error_female*df0$Standard_error_female
df0$Mean_squared=df0$Mean_female*df0$Mean_female
Selection_line_fecundity_monogamous <- df0 %>%
filter(Control_or_selection_line== "Monogamous 28")
Control_line_fecundity_monogamous<- df0 %>%
filter(Control_or_selection_line== "Control monogamous 20")
df1<- left_join(Selection_line_fecundity_monogamous,Control_line_fecundity_monogamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_monogamous = Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_mean_fecundity_monogamous*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean_fecundity_monogamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity monogamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_mean_fecundity_monogamous-Combined_CI, ymax=Relative_mean_fecundity_monogamous+Combined_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
View(df0)
View(Selection_line_fecundity_monogamous)
View(Selection_line_fecundity_monogamous)
Combined_CI
df1$Combined_CI
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
setwd("/home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review/Graphs_and_R_codes/Two _point_papers/1_data_two_point_assay")
df<-read.table(file="Plesnar_Bielak_et_al_2012.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-28
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Standard_error_female))
df0 <- df%>% slice(1:9)
df0$Error_squared= df0$Standard_error_female*df0$Standard_error_female
df0$Mean_squared=df0$Mean_female*df0$Mean_female
Selection_line_fecundity_monogamous <- df0 %>%
filter(Control_or_selection_line== "Monogamous 28")
Control_line_fecundity_monogamous<- df0 %>%
filter(Control_or_selection_line== "Control monogamous 20")
df1<- left_join(Selection_line_fecundity_monogamous,Control_line_fecundity_monogamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_monogamous = Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_mean_fecundity_monogamous*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean_fecundity_monogamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity monogamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_mean_fecundity_monogamous-Combined_CI, ymax=Relative_mean_fecundity_monogamous+Combined_CI), width=.4)
#              position=position_dodge(.9) +geom_point()
print(a)
View(df)
df3 <- df%>% slice(1:9)
Selection_line_fecundity_polygamous <- df3 %>%
filter(Control_or_selection_line== "Polygamous 28")
Control_line_fecundity_polygamous<- df3 %>%
filter(Control_or_selection_line== "Control polygamous 20")
df4<- left_join(Selection_line_fecundity_polygamous,Control_line_fecundity_polygamous, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean_fecundity_polygamous = Mean_female.s /Mean_female.c)
b<- ggplot(df4, aes(x=New_X_axis, y=Relative_mean_fecundity_polygamous ,fill= )) +
geom_line() +geom_point()+
ggtitle("Mating system affects population performance
and extinction risk under environmental challenge		") +
ylab("fecundity polygamous relative fitness")+ geom_hline(yintercept=1)+ylim(0,2)+geom_vline(xintercept = 0)+xlim(-20,20)
#geom_errorbar(aes(ymin=Mean_female-Calc_CI, ymax=Mean_female+Calc_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(b)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
library(tidyr)
df<-read.table(file="/home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review/1_data/1_data_multipoint_assay/Schaum_et_al_2017.txt" ,header= TRUE,sep = " ")
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Error))
df0 <- df%>% slice(1:16)
df0$Error_squared= df0$Error*df0$Error
df0$Mean_squared=df0$Mean*df0$Mean
Selection_line <- df0 %>%
filter(Selection_temperature== "Ambient+4")
Control_line<- df0 %>%
filter(Selection_temperature== "Ambient")
df1 <- left_join(Selection_line,Control_line, by = "Assay_temperature_in_paper", suffix = c(".s", ".c")) %>%
mutate(Relative_mean = Mean.s/Mean.c)%>%
mutate(Combined_Standard_error=Relative_mean*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=Assay_temperature_in_paper, y=Relative_mean,fill= )) +
geom_line() +geom_point()+
ggtitle("Adaptation of phytoplankton to a decade of experimental
warming linked to increased photosynthesis	") +
ylab("ln mu max")+ geom_hline(yintercept=1)+ylim(-1.5,2.5)+
geom_errorbar(aes(ymin=Relative_mean-Combined_CI, ymax=Relative_mean+Combined_CI), width=.2,)
#  position=position_dodge(.9) +geom_point()
print(a)
setwd(home/sarthak/Documents/2020_04_01_SM_Temperature_niche_review)
setwd(home/sarthak/Documents)
library(tidyr)
setwd("~/Documents/2020_04_01_SM_Temperature_niche_review/3_R_scripts/3_R_scripts_multipoint_assay")
df<-read.table(file="../../1_data/1_data_multipoint_assay/Schaum_et_al_2017.txt" ,header= TRUE,sep = " ")
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
library(tidyr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Schaum_et_al_2017.txt" ,header= TRUE,sep = " ")
View(df)
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$Error))
df0 <- df%>% slice(1:16)
df0$Error_squared= df0$Error*df0$Error
df0$Mean_squared=df0$Mean*df0$Mean
Selection_line <- df0 %>%
filter(Selection_temperature== "Ambient+4")
Control_line<- df0 %>%
filter(Selection_temperature== "Ambient")
df1 <- left_join(Selection_line,Control_line, by = "Assay_temperature_in_paper", suffix = c(".s", ".c")) %>%
mutate(Relative_mean = Mean.s/Mean.c)%>%
mutate(Combined_Standard_error=Relative_mean*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=Assay_temperature_in_paper, y=Relative_mean,fill= )) +
geom_line() +geom_point()+
ggtitle("Adaptation of phytoplankton to a decade of experimental
warming linked to increased photosynthesis	") +
ylab("ln mu max")+ geom_hline(yintercept=1)+ylim(-1.5,2.5)+
geom_errorbar(aes(ymin=Relative_mean-Combined_CI, ymax=Relative_mean+Combined_CI), width=.2,)
#  position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Blaby_et_al_2012.txt",header= TRUE,sep = " ")
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df0 <- df%>% slice(3:16)
df0$New_X_axis=df0$Assay_temperature-49.7
Selection_line <- df0 %>%
filter(Control_or_selection_line== "EVG1064 49.7 degree")
Control_line<- df0 %>%
filter(Control_or_selection_line== "MG1655")
df0 <- left_join(Selection_line,Control_line, by = "New_X_axis", suffix = c("_s", "_c")) %>%
mutate(Relative_mean = Mean_sex_not_considered_s/Mean_sex_not_considered_c)
a<- ggplot(df0, aes(x=New_X_axis, y=Relative_mean,fill= )) +
geom_line() +geom_point()+
ggtitle("Experimental Evolution of a Facultative Thermophile from a Mesophilic Ancestor") +
ylab("Mean generation time (min^-1)   Relative ")+ geom_hline(yintercept=1)+ylim(0,2)+xlim(-20, 20)+geom_vline(xintercept=0)
print(a)
Sel_temp<-df0$Selection_temperature_s
New_X_axis<-df0$New_X_axis
Rel_fitness<-df0$Relative_mean
CI<-df0$Confidence_interval._s
df1 <- df%>% slice(22:35)
df1$New_X_axis=df1$Assay_temperature-49.7
Selection_line <- df1 %>%
filter(Control_or_selection_line== "EVG1064 49.7 degree")
Control_line<- df1 %>%
filter(Control_or_selection_line== "MG1655")
df1 <- left_join(Selection_line,Control_line, by = "New_X_axis", suffix = c("_s", "_c")) %>%
mutate(Relative_mean = Mean_sex_not_considered_s/Mean_sex_not_considered_c)
b<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean,fill= )) +
geom_line() +geom_point()+
ggtitle("Experimental Evolution of a Facultative Thermophile from a Mesophilic Ancestor") +
ylab("Optical density OD 600    standard deviation shown")+ geom_hline(yintercept=1)+ylim(0,25)+xlim(-20, 20)+geom_vline(xintercept=0)
#geom_errorbar(aes(ymin=Mean_sex_not_considered-standard_deviation, ymax=Mean_sex_not_considered+standard_deviation), width=.2,)
#              position=position_dodge(.9) +geom_point()
print(b)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
library(tibble)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Arribas_et_al_2014.txt" ,header= TRUE,sep = " ")
View(df)
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df1 <- df%>% slice(2:38)
df1$standard_error = df1$standard_deviation/sqrt(3)
df1$New_X_axis=df1$Assay_temperature-df1$Selection_temperature
Selection_line <- df1 %>%
filter(Control_or_selection_line== "Selection line")
Control_line<- df1 %>%
filter(Control_or_selection_line== "Anc")
df1<- left_join(Selection_line,Control_line, by = c("Selection_temperature","New_X_axis","Replicate","Plotting"), suffix = c(".s", ".c"))%>%
mutate(Relative_mean =Mean.s /Mean.c) %>%
mutate(Combined_Standard_error=standard_error.s/Mean.c)%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_mean,fill= )) +
geom_line(aes(group=Plotting, color=Plotting)) +geom_point(aes(group=Plotting, color=Plotting))+
ggtitle("Adaptation to Fluctuating Temperatures in an RNA
Virus is Driven by the Most Stringent Selective Pressure") +
ylab("Growth rate e log2 [(virusend – virus0)/virus0]  Relative fitness")  +
ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)+
geom_errorbar(aes(ymin=Relative_mean-Combined_CI, ymax=Relative_mean+Combined_CI), width=.2,)
#              position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Lenski_and_Bennett_1993.txt" ,header= TRUE,sep = " ")
df0 <- df%>% slice(1:28)
df0$Selection_temperature=as.numeric(df0$Selection_temperature)
df0$New_X_axis=df0$Assay_temperature-df0$Selection_temperature
a<- ggplot(df0, aes(x=New_X_axis, y=Mean_sex_not_considered,fill= )) +
geom_line(aes(group=Control_or_selection_line, color=Control_or_selection_line)) +geom_point(aes(color=Control_or_selection_line))+
ggtitle("Evolutionary Response of Escherichia-Coli to Thermal-Stress	") +
ylab("Fitness relative to ancestor	") +ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Cooper_et_al_2001.txt" ,header= TRUE,sep = " ")
m<-1.96
t<-1
calc_SE<- function(x) x/m
df$standard_error<-(calc_SE(df$Confidence_interval))
#Calculating squares of mean and standard errors
df$Error_squared= df$standard_error*df$standard_error
df$Mean_squared=df$Mean_sex_not_considered*df$Mean_sex_not_considered
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df0 <- df%>% slice(2:19)
df0$New_X_axis=df0$Assay_temperature-37
Selection_line <- df0 %>%
filter(Control_or_selection_line== "degrees for 2000 generations")
Control_line <- df0 %>%
filter(Control_or_selection_line== "Ancestor")
df0 <- left_join(Selection_line,Control_line, by = "New_X_axis", suffix = c(".s", ".c")) %>%
mutate(Relative_mean = Mean_sex_not_considered.s/Mean_sex_not_considered.c)%>%
mutate(Combined_Standard_error=Relative_mean*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
# mutate(Total_error= Error.s + Error.c)
a<- ggplot(df0, aes(x=New_X_axis, y=Relative_mean,fill= )) +
geom_line() +geom_point()+
ggtitle("Evolution of thermal dependence of growth rate of Escherichia coli populations
during 20,000 generations in a constant environment") +
ylab("Maximum growth rate Vmax  relative fitness") +
ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)+
geom_errorbar(aes(ymin=Relative_mean-Combined_CI, ymax=Relative_mean+Combined_CI), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Mongold_et_al.txt" ,header= TRUE,sep = " ")
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df0 <- df%>% slice(2:6)
df0$New_X_axis=df0$Assay_temperature-df0$Selection_temperature
a<- ggplot(df0, aes(x=New_X_axis, y=Mean_sex_not_considered,fill= )) +
geom_line(aes(group=Selection_temperature, color=Selection_temperature)) +geom_point(aes(color=Selection_temperature))+
ggtitle("Evolutionary adaptation to temperature .4. Adaptation of Escherichia coli at a niche boundary	") +
ylab("Fitness relative to ancestor	")+
geom_errorbar(aes(ymin=Mean_sex_not_considered-Confidence_interval., ymax=Mean_sex_not_considered+Confidence_interval.), width=.2)+
geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)+ylim(0,2)
#              position=position_dodge(.9) +geom_point()
print(a)
Sel_temp<-df0$Selection_temperature
New_X_axis<-df0$New_X_axis
Rel_fitness<-df0$Mean_sex_not_considered
CI<-df0$Confidence_interval.
Replicate<-df0$Replicate
Paper_id<-replicate(5,"Mongold")
Data_frame_Mongold<-cbind(Paper_id,Sel_temp,New_X_axis,Rel_fitness,CI,Replicate)
write.table(Data_frame_Mongold,file = "Data_frame_Mongold.txt",sep = " ")
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Santos_2007.txt" ,header= TRUE,sep = " ")
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df0 <- df%>% slice(2:10)
df0$New_X_axis=df0$Assay_Temperature-df0$Selection_temperature
a<- ggplot(df0, aes(x=New_X_axis, y=Mean_sex_not_considered ,fill= )) +
geom_line(aes(group=Selection_temperature, color=Selection_temperature)) +geom_point(aes(color=Selection_temperature))+
ggtitle("Evolution of total net fitness in thermal lines: Drosophila subobscura likes it 'warm'	") +
ylab("Average fitness (relative to Va/+ flies)	")+ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)+
geom_errorbar(aes(ymin=Mean_sex_not_considered-Confidence_interval., ymax=Mean_sex_not_considered+Confidence_interval.,color=Selection_temperature ), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
Sel_temp<-df0$Selection_temperature
New_X_axis<-df0$New_X_axis
Rel_fitness<-df0$Mean_sex_not_considered
CI<-df0$Confidence_interval.
Paper_id<-replicate(9,"Santos")
Replicate<-df0$Replicate
Data_frame_Santos<-cbind(Paper_id,Sel_temp,New_X_axis,Rel_fitness,CI,Replicate)
write.table(Data_frame_Santos,file = "Data_frame_Santos.txt",sep = " ")
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_multipoint_assay/Santos_2007.txt" ,header= TRUE,sep = " ")
# Adaptation of phytoplankton to a decade of experimental warming linked to increased photosynthesis
df0 <- df%>% slice(2:10)
df0$New_X_axis=df0$Assay_Temperature-df0$Selection_temperature
a<- ggplot(df0, aes(x=New_X_axis, y=Mean_sex_not_considered ,fill= )) +
geom_line(aes(group=Selection_temperature, color=Selection_temperature)) +geom_point(aes(color=Selection_temperature))+
ggtitle("Evolution of total net fitness in thermal lines: Drosophila subobscura likes it 'warm'	") +
ylab("Average fitness (relative to Va/+ flies)	")+ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept=0)+xlim(-20, 20)+
geom_errorbar(aes(ymin=Mean_sex_not_considered-Confidence_interval., ymax=Mean_sex_not_considered+Confidence_interval.,color=Selection_temperature ), width=.2)
#              position=position_dodge(.9) +geom_point()
print(a)
Sel_temp<-df0$Selection_temperature
New_X_axis<-df0$New_X_axis
Rel_fitness<-df0$Mean_sex_not_considered
CI<-df0$Confidence_interval.
Paper_id<-replicate(9,"Santos")
Replicate<-df0$Replicate
Data_frame_Santos<-cbind(Paper_id,Sel_temp,New_X_axis,Rel_fitness,CI,Replicate)
write.table(Data_frame_Santos,file = "../../1_data/1_data_multipoint_assay/Combined_graph_dataframes/Data_frame_Santos.txt",sep = " ")
setwd("~/Documents/2020_04_01_SM_Temperature_niche_review/3_R_scripts/3_R_script_two_point_assay")
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_two_point_assay/Huey_et_al_1991.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-16.5
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$standard_error))
df0 <- df%>% slice(1:4)
df0$Error_squared= df0$standard_error*df0$standard_error
df0$Mean_squared=df0$Mean_male*df0$Mean_male
Selection_line_male<- df0 %>%
filter(Control_or_selection_line== "dev temp 16.5")
Control_line_male<- df0 %>%
filter(Control_or_selection_line== "dev temp 25")
df1<- left_join(Selection_line_male,Control_line_male, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_fitness_male =Mean_male.s /Mean_male.c)%>%
mutate(Combined_Standard_error=Relative_fitness_male*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_fitness_male ,fill= )) +
geom_line() +geom_point()+
ggtitle("THERMAL SENSITIVITY OF DROSOPHILA MELANOGASTER
RESPONDS RAPIDLY TO LABORATORY NATURAL SELECTION") +
ylab("Development time 	male Relative fitness")+ ylim(0,2)+ geom_hline(yintercept=1)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_fitness_male-Combined_CI, ymax=Relative_fitness_male+Combined_CI), width=.2,)
#              position=position_dodge(.9) +geom_point()
print(a)
library(ggplot2)
library(reshape)
library(dplyr)
library(ggpubr)
df<-read.table(file="../../1_data/1_data_two_point_assay/Huey_et_al_1991.txt" ,header= TRUE,sep = " ")
df$New_X_axis=df$Assay_temperature-16.5
m=1.96
Calc_CI<-function(x) m*x
df$Calc_CI<-(Calc_CI(df$standard_error))
df0 <- df%>% slice(1:4)
df0$Error_squared= df0$standard_error*df0$standard_error
df0$Mean_squared=df0$Mean_male*df0$Mean_male
Selection_line_male<- df0 %>%
filter(Control_or_selection_line== "dev temp 16.5")
Control_line_male<- df0 %>%
filter(Control_or_selection_line== "dev temp 25")
df1<- left_join(Selection_line_male,Control_line_male, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_fitness_male =Mean_male.s /Mean_male.c)%>%
mutate(Combined_Standard_error=Relative_fitness_male*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
a<- ggplot(df1, aes(x=New_X_axis, y=Relative_fitness_male ,fill= )) +
geom_line() +geom_point()+
ggtitle("THERMAL SENSITIVITY OF DROSOPHILA MELANOGASTER
RESPONDS RAPIDLY TO LABORATORY NATURAL SELECTION") +
ylab("Development time 	male Relative fitness")+ ylim(0,2)+ geom_hline(yintercept=1)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_fitness_male-Combined_CI, ymax=Relative_fitness_male+Combined_CI), width=.2,)
#              position=position_dodge(.9) +geom_point()
print(a)
Sel_temp<-df1$Selection_temperature.s
New_X_axis<-df1$New_X_axis
Rel_fitness<-df1$Relative_fitness_male
CI<-df1$Confidence_interval.s
Paper_id<-replicate(2,"Huey_male")
Replicate<-df1$Replicate.s
Data_frame_Huey_male<-cbind(Paper_id,Sel_temp,New_X_axis,Rel_fitness,CI,Replicate)
write.table(Data_frame_Huey_male,file = "../../1_data/1_data_two_point_assay/Combined_graph_dataframes/Data_frame_Huey_male.txt",sep = " ")
###########################################################################################################################################
df2 <- df%>% slice(6:9)
df2$New_X_axis=df2$Assay_temperature-16.5
df2$Error_squared= df2$standard_error*df2$standard_error
df2$Mean_squared=df2$Mean_female*df2$Mean_female
Selection_line_female<- df2 %>%
filter(Control_or_selection_line== "dev temp 16.5")
Control_line_female<- df2 %>%
filter(Control_or_selection_line== "dev temp 25")
df3<- left_join(Selection_line_female,Control_line_female, by = c("New_X_axis"), suffix = c(".s", ".c"))%>%
mutate(Relative_fitness_female =Mean_female.s /Mean_female.c)%>%
mutate(Combined_Standard_error=Relative_fitness_female*sqrt((Error_squared.s/Mean_squared.s)+(Error_squared.c/Mean_squared.c)))%>%
mutate(Absolute_combined_error=abs(Combined_Standard_error))%>%
mutate(Combined_CI = Absolute_combined_error*1.96)
b<- ggplot(df3, aes(x=New_X_axis, y=Relative_fitness_female ,fill= )) +
geom_line() +geom_point()+
ggtitle("THERMAL SENSITIVITY OF DROSOPHILA MELANOGASTER
RESPONDS RAPIDLY TO LABORATORY NATURAL SELECTION")+
ylab("Development time 	female relative fitness") + ylim(0,2)+geom_hline(yintercept=1)+geom_vline(xintercept = 0)+xlim(-20,20)+
geom_errorbar(aes(ymin=Relative_fitness_female-Combined_CI, ymax=Relative_fitness_female+Combined_CI), width=.2,)
#              position=position_dodge(.9) +geom_point()
print(b)
Sel_temp<-df3$Selection_temperature.s
New_X_axis<-df3$New_X_axis
Rel_fitness<-df3$Relative_fitness_female
CI<-df3$Confidence_interval.s
Paper_id<-replicate(2,"Huey_female")
Replicate<-df3$Replicate.s
Data_frame_Huey_female<-cbind(Paper_id,Sel_temp,New_X_axis,Rel_fitness,CI,Replicate)
write.table(Data_frame_Huey_female,file = "../../1_data/1_data_two_point_assay/Combined_graph_dataframes/Data_frame_Huey_female.txt",sep = " ")
######################################################################################################################################3333333
